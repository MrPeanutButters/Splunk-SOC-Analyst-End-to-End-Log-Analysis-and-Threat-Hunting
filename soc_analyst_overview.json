{
  "description": "SOC Analyst Overview \u2014 panels for authentication, processes, IDS, and DNS hunting.",
  "title": "SOC Analyst Overview",
  "visualizations": {
    "viz_failed_logins_time": {
      "type": "splunk.line",
      "title": "Failed Logins Over Time",
      "dataSources": [
        "ds_failed_logins_time"
      ],
      "options": {
        "legend": {
          "visible": true
        }
      }
    },
    "viz_failed_logins_top_ip": {
      "type": "splunk.bar",
      "title": "Top Source IPs by Failed Logins",
      "dataSources": [
        "ds_failed_logins_top_ip"
      ]
    },
    "viz_suspicious_procs": {
      "type": "splunk.table",
      "title": "Suspicious Parent-Child Processes",
      "dataSources": [
        "ds_suspicious_procs"
      ]
    },
    "viz_suricata_alerts": {
      "type": "splunk.bar",
      "title": "Top Suricata Alerts",
      "dataSources": [
        "ds_suricata_alerts"
      ]
    },
    "viz_dns_beaconing": {
      "type": "splunk.scatter",
      "title": "High-Frequency DNS Queries",
      "dataSources": [
        "ds_dns_beaconing"
      ]
    }
  },
  "dataSources": {
    "ds_failed_logins_time": {
      "type": "ds.search",
      "options": {
        "query": "search `base_indexes` sourcetype=WinEventLog:Security EventCode=4625 earliest=-24h@h latest=now\n| timechart span=5m count",
        "queryParameters": {},
        "refresh": {
          "type": "delay",
          "interval": 300
        }
      }
    },
    "ds_failed_logins_top_ip": {
      "type": "ds.search",
      "options": {
        "query": "search `base_indexes` sourcetype=WinEventLog:Security EventCode=4625 earliest=-24h@h latest=now\n| stats count by src_ip\n| sort - count\n| head 20"
      }
    },
    "ds_suspicious_procs": {
      "type": "ds.search",
      "options": {
        "query": "search `base_indexes` index=sysmon EventCode=4688 earliest=-24h@h latest=now\n| where like(ParentImage, \"%powershell.exe\") AND like(NewProcessName, \"%cmd.exe\")\n| stats count by _time, User, ParentImage, NewProcessName, CommandLine\n| sort - _time"
      }
    },
    "ds_suricata_alerts": {
      "type": "ds.search",
      "options": {
        "query": "search `base_indexes` sourcetype=suricata:json event_type=alert earliest=-24h@h latest=now\n| stats count by signature, src_ip, dest_ip\n| sort - count\n| head 20"
      }
    },
    "ds_dns_beaconing": {
      "type": "ds.search",
      "options": {
        "query": "search `base_indexes` sourcetype=zeek:dns earliest=-24h@h latest=now\n| stats count by query, src_ip\n| where count > `threshold_dns_beacon`\n| rename count as freq"
      }
    }
  },
  "layout": {
    "type": "grid",
    "options": {
      "width": 1440,
      "height": 1024,
      "display": "auto"
    },
    "structure": [
      [
        {
          "item": "viz_failed_logins_time",
          "type": "block",
          "position": {
            "x": 0,
            "y": 0,
            "w": 9,
            "h": 6
          }
        },
        {
          "item": "viz_failed_logins_top_ip",
          "type": "block",
          "position": {
            "x": 9,
            "y": 0,
            "w": 7,
            "h": 6
          }
        }
      ],
      [
        {
          "item": "viz_suspicious_procs",
          "type": "block",
          "position": {
            "x": 0,
            "y": 6,
            "w": 16,
            "h": 5
          }
        }
      ],
      [
        {
          "item": "viz_suricata_alerts",
          "type": "block",
          "position": {
            "x": 0,
            "y": 11,
            "w": 8,
            "h": 5
          }
        },
        {
          "item": "viz_dns_beaconing",
          "type": "block",
          "position": {
            "x": 8,
            "y": 11,
            "w": 8,
            "h": 5
          }
        }
      ]
    ]
  },
  "defaults": {
    "dataSources": {
      "queryParameters": {}
    },
    "visualizations": {
      "options": {
        "showProgressBar": true
      }
    }
  },
  "inputs": {}
}