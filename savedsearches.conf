# Saved searches for SOC detection and triage
[Brute Force - Excessive Failed Logons]
search = search `base_indexes` `win_failed_logons` | stats count by Account_Name, src_ip | where count > `threshold_failed_logons(10)`
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
cron_schedule = */10 * * * *
alert_type = always
alert.severity = 5
alert.track = 1
alert.digest_mode = 1
alert.suppress = 0
actions =

[Suspicious Parent-Child - PowerShell Spawns cmd.exe]
search = search `base_indexes` `sysmon_process_create` | where like(ParentImage, "%powershell.exe") AND like(NewProcessName, "%cmd.exe") | stats earliest(_time) as firstSeen latest(_time) as lastSeen count by User, ParentImage, NewProcessName, CommandLine, src_ip
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
cron_schedule = */15 * * * *
alert_type = always
alert.severity = 4
alert.track = 1
alert.digest_mode = 1
alert.suppress = 0
actions =

[Recon - Suricata Portscan Signatures]
search = search `base_indexes` `suricata_alerts` | stats count by signature, src_ip, dest_ip | sort - count | head 50
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
cron_schedule = */15 * * * *
alert_type = always
alert.severity = 3
alert.track = 1
alert.digest_mode = 1
alert.suppress = 0
actions =

[DNS Beaconing - High Frequency Queries]
search = search `base_indexes` `zeek_dns` | stats count by query, src_ip | where count > `threshold_dns_beacon` | rename count as freq
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
cron_schedule = */20 * * * *
alert_type = always
alert.severity = 3
alert.track = 1
alert.digest_mode = 1
alert.suppress = 0
actions =
